CREATE TABLE UNIT_OF_MEANSURE(
	ABBREVIATION CHAR (2) NOT NULL UNIQUE,
	NAME VARCHAR (20) NOT NULL,
	CONSTRAINT PRK_ABBR PRIMARY KEY (ABBREVIATION)
);

CREATE TABLE PRODUCTS(
	ID_PRODUCTS SERIAL,
	ABBREVIATION CHAR (2),
	PRODUCT_NAME VARCHAR (120) NOT NULL,
	DESCRIPTION VARCHAR (100) NULL,
	CONSTRAINT PRK_PRODUCTS PRIMARY KEY (ID_PRODUCTS),
	CONSTRAINT FRK_UNIT_MEANSURE FOREIGN KEY (ABBREVIATION)
	REFERENCES UNIT_OF_MEANSURE (ABBREVIATION)
);

CREATE TABLE PRODUCT_MEASUREMENT(
	ID_PRODUCTS INT NOT NULL,
	ABBREVIATION CHAR (2) NOT NULL,
	FACTOR_CONVERSION DECIMAL (10,4),
	CONSTRAINT PRK_PRODUCT_MEASUREMENT PRIMARY KEY (ID_PRODUCTS, ABBREVIATION),
	CONSTRAINT FRK_PRODUCTS FOREIGN KEY (ID_PRODUCTS)
	REFERENCES PRODUCTS (ID_PRODUCTS),
	CONSTRAINT FRK_UNIT_MEANSURE FOREIGN KEY (ABBREVIATION)
	REFERENCES UNIT_OF_MEANSURE (ABBREVIATION)
	
);

CREATE TABLE PRODUCT_HISTORY (
	ID_PRODUCT_HISTORY SERIAL PRIMARY KEY,
	ID_PRODUCTS INT NOT NULL,
	DATE_CHANGE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	CONSTRAINT FRK_PRODUCT_HISTORY FOREIGN KEY (ID_PRODUCTS)
	REFERENCES PRODUCTS (ID_PRODUCTS)
	
);

CREATE TABLE BARCODE_NUMBER (
  ID_CODIGO_BARRAS SERIAL PRIMARY KEY,
  ID_PRODUCTS INT NOT NULL,
  COD_EAN VARCHAR(14) NOT NULL,
  IS_SYSTEM_GENERATED BOOLEAN NOT NULL DEFAULT FALSE,
  IS_DEFAULT BOOLEAN NOT NULL DEFAULT FALSE,
  CONSTRAINT FK_BARCODE_NUMBER_ID_PRODUCTS FOREIGN KEY (ID_PRODUCTS)
  REFERENCES PRODUCTS (ID_PRODUCTS)
);

CREATE TABLE DOCUMENTS (
  ID_DOCUMENTS SERIAL PRIMARY KEY,
  DOCUMENT_NUM VARCHAR(50) NULL,
  ISSUE_DATE TIMESTAMP NOT NULL,
  VALUE_OF_DOCUMENT DECIMAL(10, 2) NOT NULL,
  PAID_AMOUNT DECIMAL(10, 2) NOT NULL
);

CREATE TABLE DOCUMENT_ITENS(
	ID_DOCUMENT_ITENS SERIAL PRIMARY KEY,
	ID_DOCUMENTS INT NOT NULL,
	ID_PRODUCTS INT NOT NULL,
	UNITARY_VALUE DECIMAL (10,2),
	QUANTITY DECIMAL (10,2),
	CONSTRAINT FRK_DOCUMENT_ITENS FOREIGN KEY (ID_DOCUMENTS)
	REFERENCES DOCUMENTS (ID_DOCUMENTS)
);

CREATE TABLE FORM_OF_PAYMENTS (
	ID_FORM_OF_PAYMENTS SERIAL PRIMARY KEY,
	PAYMENT_NAME VARCHAR (25) NOT NULL	
);

CREATE TABLE PAY_METHOD_DOCS (
	ID_DOCUMENTS INT NOT NULL,
	ID_FORM_OF_PAYMENTS INT NOT NULL,
	CONSTRAINT PRK_PAY_METHOD_DOCS PRIMARY KEY (ID_DOCUMENTS, ID_FORM_OF_PAYMENTS),
	CONSTRAINT FRK_METHOD_DOCS FOREIGN KEY (ID_DOCUMENTS)
	REFERENCES DOCUMENTS (ID_DOCUMENTS),
	CONSTRAINT FRK_FORM_METHOD_DOCS FOREIGN KEY (ID_FORM_OF_PAYMENTS)
	REFERENCES FORM_OF_PAYMENTS (ID_FORM_OF_PAYMENTS)
	
);

-- INSERÇÃO NA TABELA UNIDADE DE MEDIDA

INSERT INTO unit_of_meansure (abbreviation, name_unit)
VALUES
  ('KG', 'QUILOGRAMA'),
  ('G', 'GRAMA'),
  ('L', 'LITRO'),
  ('ML', 'MILILITRO'),
  ('M', 'METRO'),
  ('CM', 'CENTÍMETRO'),
  ('UN', 'UNIDADE'),
  ('PC', 'PEÇA'),
  ('%', 'PORCENTAGEM');

-- INSERÇÃO NA TABELA FORMA DE PAGAMENTOS
